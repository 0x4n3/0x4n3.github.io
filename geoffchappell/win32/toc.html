<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>MSVC - The !CPUID Shuffle</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../Overview.html"><strong aria-hidden="true">1.</strong> Overview</a></li><li class="chapter-item expanded affix "><li class="part-title">CVE Analysis</li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> CVE-2018-0617</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> CVE-2019-0539</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> CVE-2019-0567</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> CVE-2019-0983</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> CVE-2019-0998</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> CVE-2020-0871</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> CVE-2021-1648</div></li><li class="chapter-item expanded "><a href="../../cve/CVE-2021-31956.html"><strong aria-hidden="true">9.</strong> CVE-2021-31956</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> CVE-2021-31969</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.</strong> CVE-2022-22715</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">12.</strong> CVE-2023-21766</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.</strong> CVE-2023-28229</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">14.</strong> CVE-2023-35359</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.</strong> CVE-2023-36906</div></li><li class="chapter-item expanded affix "><li class="part-title">Tools</li><li class="chapter-item expanded "><a href="../../tools/WinDbg.html"><strong aria-hidden="true">16.</strong> Microsoft WinDbg</a></li><li class="chapter-item expanded affix "><li class="part-title">Shellcode Theory</li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.</strong> Return-Oriented Programming</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.</strong> Jump-Oriented Programming</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">19.</strong> Call-Oriented Programming</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">20.</strong> Process Injection</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.</strong> Token Stealing</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">22.</strong> ACL Editing</div></li><li class="chapter-item expanded affix "><li class="part-title">Resources</li><li class="chapter-item expanded "><a href="../../resources/Windows.html"><strong aria-hidden="true">23.</strong> Microsoft Windows</a></li><li class="chapter-item expanded "><a href="../../geoffchappell/ie/toc.html"><strong aria-hidden="true">24.</strong> Internet Explorer</a></li><li class="chapter-item expanded "><a href="../../geoffchappell/kernel/toc.html"><strong aria-hidden="true">25.</strong> Kernel</a></li><li class="chapter-item expanded "><a href="../../geoffchappell/notes/toc.html"><strong aria-hidden="true">26.</strong> Notes</a></li><li class="chapter-item expanded "><a href="../../geoffchappell/shell/toc.html"><strong aria-hidden="true">27.</strong> Shell</a></li><li class="chapter-item expanded "><a href="../../geoffchappell/win32/toc.html" class="active"><strong aria-hidden="true">28.</strong> Win32</a></li><li class="chapter-item expanded "><a href="../../geoffchappell/win32/toc.html" class="active"><strong aria-hidden="true">29.</strong> MSVC</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The !CPUID Shuffle</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Security-Policy" content="base-uri 'none'; default-src 'none'; form-action 'none'; img-src 'self'; script-src 'self'; style-src 'self'">
<title>Table of Contents - Win32</title>
<meta name="author" content="Geoff Chappell">
<meta name="description" content="Table of Contents for Win32 programming at the Geoff Chappell website">
<base target="NoScript Document Window for Geoff Chappell Site">
<link rel="stylesheet" type="text/css" href="../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/toc.css">
<script type="text/javascript" src="../../../_scripts/toc.js"></script>
<script type="text/javascript" src="../../../_scripts/tocui.js" defer></script>
</head>
<body>
<div class="Nav" id="Toc">
  <ul id="Root">
    <li class="Folder"><a href="index.htm">Win32</a> 
<ul>
  <li class="Folder"><a href="apisetschema/index.htm">ApiSetSchema</a> 
<ul>
  <li class="Folder"><a href="apisetschema/history/index.htm">Versions</a> 
  <ul>
    <li><a href="apisetschema/history/sets61.htm">6.1</a> </li>
    <li><a href="apisetschema/history/sets62.htm">6.2</a> </li>
    <li><a href="apisetschema/history/sets63.htm">6.3</a> </li>
    <li><a href="apisetschema/history/sets100.htm">10.0</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="apisetschema/api/index.htm">API Sets</a> 
  <ul>
    <li><a href="apisetschema/api/ms/win/core/console/l1-1-0.htm">API-MS-Win-Core-Console-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/datetime/l1-1-0.htm">API-MS-Win-Core-DateTime-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/debug/l1-1-0.htm">API-MS-Win-Core-Debug-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/delayload/l1-1-0.htm">API-MS-Win-Core-DelayLoad-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/errorhandling/l1-1-0.htm">API-MS-Win-Core-ErrorHandling-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/fibers/l1-1-0.htm">API-MS-Win-Core-Fibers-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/file/l1-1-0.htm">API-MS-Win-Core-File-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/handle/l1-1-0.htm">API-MS-Win-Core-Handle-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/heap/l1-1-0.htm">API-MS-Win-Core-Heap-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/interlocked/l1-1-0.htm">API-MS-Win-Core-Interlocked-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/io/l1-1-0.htm">API-MS-Win-Core-IO-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/libraryloader/l1-1-0.htm">API-MS-Win-Core-LibraryLoader-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/localization/l1-1-0.htm">API-MS-Win-Core-Localization-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/localregistry/l1-1-0.htm">API-MS-Win-Core-LocalRegistry-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/memory/l1-1-0.htm">API-MS-Win-Core-Memory-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/misc/l1-1-0.htm">API-MS-Win-Core-Misc-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/namedpipe/l1-1-0.htm">API-MS-Win-Core-NamedPipe-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/processenvironment/l1-1-0.htm">API-MS-Win-Core-ProcessEnvironment-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/processthreads/l1-1-0.htm">API-MS-Win-Core-ProcessThreads-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/profile/l1-1-0.htm">API-MS-Win-Core-Profile-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/rtlsupport/l1-1-0.htm">API-MS-Win-Core-RtlSupport-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/string/l1-1-0.htm">API-MS-Win-Core-String-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/synch/l1-1-0.htm">API-MS-Win-Core-Synch-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/sysinfo/l1-1-0.htm">API-MS-Win-Core-SysInfo-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/threadpool/l1-1-0.htm">API-MS-Win-Core-ThreadPool-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/ums/l1-1-0.htm">API-MS-Win-Core-UMS-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/util/l1-1-0.htm">API-MS-Win-Core-Util-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/core/xstate/l1-1-0.htm">API-MS-Win-Core-XState-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/security/base/l1-1-0.htm">API-MS-Win-Security-Base-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/security/lsalookup/l1-1-0.htm">API-MS-Win-Security-LSALookup-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/security/sddl/l1-1-0.htm">API-MS-Win-Security-SDDL-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/service/core/l1-1-0.htm">API-MS-Win-Service-Core-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/service/management/l1-1-0.htm">API-MS-Win-Service-Management-L1-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/service/management/l2-1-0.htm">API-MS-Win-Service-Management-L2-1-0</a> </li>
    <li><a href="apisetschema/api/ms/win/service/winsvc/l1-1-0.htm">API-MS-Win-Service-winsvc-L1-1-0</a> </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="ntdll/index.htm">NTDLL</a> 
<ul>
  <li class="Folder"><a href="ntdll/history/index.htm">Versions</a>
  <ul>
    <li class="Folder">Exports History 
    <ul>
      <li><a href="ntdll/history/credibility.htm">Version Credibility</a> </li>
      <li><a href="ntdll/history/names310.htm">3.10</a> </li>
      <li><a href="ntdll/history/names350.htm">3.50</a> </li>
      <li><a href="ntdll/history/names351.htm">3.51</a> </li>
      <li><a href="ntdll/history/names40.htm">4.0</a> </li>
      <li><a href="ntdll/history/names50.htm">5.0</a> </li>
      <li><a href="ntdll/history/names51.htm">5.1</a> </li>
      <li><a href="ntdll/history/names52.htm">5.2</a> </li>
      <li><a href="ntdll/history/names60.htm">6.0</a> </li>
      <li class="Folder">6.1 
      <ul>
        <li><a href="ntdll/history/names61.htm">Named Exports</a> </li>
        <li><a href="ntdll/history/ords61.htm">Ordinal-Only Exports</a> </li>
      </ul>
      </li>
      <li><a href="ntdll/history/names62.htm">6.2</a> </li>
      <li><a href="ntdll/history/names63.htm">6.3</a> </li>
      <li><a href="ntdll/history/names100.htm">10.0</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="ntdll/api/index.htm">API</a> 
  <ul>
    <li><a href="ntdll/api/native.htm">The Native API</a> </li>
  </ul>
<ul>
  <li class="Folder">CSR Utilities
  <ul>
    <li><a href="ntdll/api/csrutil/allocatecapturebuffer.htm">CsrAllocateCaptureBuffer</a> </li>
    <li><a href="ntdll/api/csrutil/allocatecapturepointer.htm">CsrAllocateCapturePointer</a> </li>
    <li><a href="ntdll/api/csrutil/allocatemessagepointer.htm">CsrAllocateMessagePointer</a> </li>
    <li><a href="ntdll/api/csrutil/capturemessagebuffer.htm">CsrCaptureMessageBuffer</a> </li>
    <li><a href="ntdll/api/csrutil/clientcallserver.htm">CsrClientCallServer</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="ntdll/api/etw/index.htm">Event Tracing</a> 
<ul>
  <li class="Folder">Event API 
  <ul>
    <li class="Folder">Functions 
    <ul>
      <li><a href="ntdll/api/etw/evntapi/notificationregister.htm">EtwNotificationRegister</a> </li>
      <li><a href="ntdll/api/etw/evntapi/write.htm">EtwEventWrite</a> </li>
      <li><a href="ntdll/api/etw/evntapi/writeex.htm">EtwEventWriteEx</a> </li>
      <li><a href="ntdll/api/etw/evntapi/writefull.htm">EtwEventWriteFull</a> </li>
      <li><a href="ntdll/api/etw/evntapi/writenoregistration.htm">EtwEventWriteNoRegistration</a> </li>
      <li><a href="ntdll/api/etw/evntapi/writetransfer.htm">EtwEventWriteTransfer</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">Event Support 
  <ul>
    <li class="Folder">Structures 
    <ul>
      <li><a href="ntdll/api/etw/evntsup/registration_entry.htm">ETW_REGISTRATION_ENTRY</a> </li>
    </ul>
    </li>
    <li><a href="ntdll/api/etw/evntsup/reghandle.htm">The User-Mode REGHANDLE</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">GUID Registration 
  <ul>
    <li class="Folder">Functions 
    <ul>
      <li><a href="ntdll/api/etw/regguidsapi/createtraceinstanceid.htm">EtwCreateTraceInstanceId</a> </li>
      <li><a href="ntdll/api/etw/regguidsapi/gettraceenableflags.htm">EtwGetTraceEnableFlags</a> </li>
      <li><a href="ntdll/api/etw/regguidsapi/gettraceenablelevel.htm">EtwGetTraceEnableLevel</a> </li>
      <li><a href="ntdll/api/etw/regguidsapi/gettraceloggerhandle.htm">EtwGetTraceLoggerHandle</a> </li>
      <li><a href="ntdll/api/etw/regguidsapi/registertraceguids.htm">EtwRegisterTraceGuids</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">Notifications
  <ul>
    <li class="Folder">Functions 
    <ul>
      <li><a href="ntdll/api/etw/notify/send.htm">EtwSendNotification</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">User-Mode Logger 
  <ul>
    <li class="Folder">Structures 
    <ul>
      <li><a href="ntdll/api/etw/umlog/um_logger_context/index.htm">ETW_UM_LOGGER_CONTEXT</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
  <ul>
    <li><a href="ntdll/api/etw/eventwriteendscenario.htm">EtwEventWriteEndScenario</a> </li>
    <li><a href="ntdll/api/etw/eventwritestartscenario.htm">EtwEventWriteStartScenario</a> </li>
    <li><a href="ntdll/api/etw/registersecurityprovider.htm">EtwRegisterSecurityProvider</a> </li>
    <li><a href="ntdll/api/etw/writeumsecurityevent.htm">EtwWriteUMSecurityEvent</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="ntdll/api/ldrapi/index.htm">Loader Functions</a> 
  <ul>
    <li><a href="ntdll/api/ldrapi/lockloaderlock.htm">LdrLockLoaderLock</a> </li>
    <li><a href="ntdll/api/ldrapi/unlockloaderlock.htm">LdrUnlockLoaderLock</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="ntdll/api/ldrinit/index.htm">Loader Initialisation</a> 
  <ul>
    <!-- li><a href="ifeo.htm">Image File Execution Options</a> </li -->
    <li class="Folder">Functions
    <ul>
      <li><a href="ntdll/api/ldrinit/queryimagefileexecutionoptions.htm">LdrQueryImageFileExecutionOptions</a> </li>
      <li><a href="ntdll/api/ldrinit/getntversionnumbers.htm">RtlGetNtVersionNumbers</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">Run-Time Library 
  <ul>
    <li class="Folder"><a href="ntdll/api/rtl/rtlexec/index.htm">Execution</a> 
    <ul>
      <li><a href="ntdll/api/rtl/rtlexec/openimagefileoptionskey.htm">LdrOpenImageFileOptionsKey</a> </li>
      <li><a href="ntdll/api/rtl/rtlexec/queryimagefileexecutionoptionsex.htm">LdrQueryImageFileExecutionOptionsEx</a> </li>
      <li><a href="ntdll/api/rtl/rtlexec/queryimagefilekeyoption.htm">LdrQueryImageFileKeyOption</a> </li>
    </ul>
    </li>
    <li class="Folder">Process Environment 
    <ul>
      <li><a href="ntdll/api/rtl/peb/setprocessiscritical.htm">RtlSetProcessIsCritical</a> </li>
    </ul>
    </li>
    <li class="Folder"><a href="ntdll/api/rtl/regutil/index.htm">Registry Utilities</a> 
    <ul>
      <li><a href="ntdll/api/rtl/regutil/getntglobalflags.htm">RtlGetNtGlobalFlags</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">CSRSRV 
<ul>
  <li class="Folder"><a href="csrsrv/api/index.htm">API</a> 
<ul>
  <li class="Folder">API Requests 
  <ul>
    <li class="Folder">Functions 
    <ul>
      <li><a href="csrsrv/api/apireqst/callserverfromserver.htm">CsrCallServerFromServer</a> </li>
    </ul>
    </li>
    <li class="Folder">Structures 
    <ul>
      <li><a href="csrsrv/api/apireqst/api_connectinfo.htm">CSR_API_CONNECTINFO</a> </li>
      <li><a href="csrsrv/api/apireqst/api_msg.htm">CSR_API_MSG</a> </li>
      <li><a href="csrsrv/api/apireqst/capture_header.htm">CSR_CAPTURE_HEADER</a> </li>
    </ul>
    </li>
    <li class="Folder">Enumerations 
    <ul>
      <li><a href="csrsrv/api/apireqst/reply_status.htm">CSR_REPLY_STATUS</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">Process 
  <ul>
    <li class="Folder">Structures 
    <ul>
      <li><a href="csrsrv/api/process/process.htm">CSR_PROCESS</a> </li>
      <li><a href="csrsrv/api/process/thread.htm">CSR_THREAD</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">Server Initialisation
  <ul>
    <li><a href="csrsrv/api/srvinit/apidispatch.htm">API Routines</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="csrsrv/api/srvloadr/index.htm">Server DLLs</a>
  <ul>
    <li class="Folder">Structures 
    <ul>
      <li><a href="csrsrv/api/srvloadr/server_dll.htm">CSR_SERVER_DLL</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">BASESRV
<ul>
  <li class="Folder"><a href="basesrv/api/index.htm">API</a> 
<ul>
  <li class="Folder">Server Initialisation
  <ul>
    <li><a href="basesrv/api/srvinit/apidispatch.htm">API Routines</a> </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">WINSRV
<ul>
  <li class="Folder">API 
<ul>
  <li class="Folder">Console Server 
<ul>
  <li class="Folder">Server Initialisation
  <ul>
    <li><a href="winsrv/api/wincon/srvinit/apidispatch.htm">API Routines</a> </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">User Server 
<ul>
  <li class="Folder">Server
  <ul>
    <li><a href="winsrv/api/user/server/apidispatch.htm">API Routines</a> </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">KERNELBASE 
<ul>
  <li class="Folder"><a href="kernelbase/history/index.htm">Versions</a> 
  <ul>
    <li><a href="kernelbase/history/names61.htm">6.1</a> </li>
    <li><a href="kernelbase/history/names62.htm">6.2</a> </li>
    <li><a href="kernelbase/history/names63.htm">6.3</a> </li>
    <li><a href="kernelbase/history/names100.htm">10.0</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li><a href="kernelbase/api/index.htm">Functions</a> </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">KERNEL32 
<ul>
  <li class="Folder"><a href="kernel32/history/index.htm">Versions</a>
  <ul>
    <li><a href="kernel32/history/names351.htm">3.51</a> </li>
    <li class="Folder">4.0
    <ul>
      <li><a href="kernel32/history/names40.htm">Named Exports</a> </li>
      <li><a href="kernel32/history/ords40.htm">Ordinal-Only Exports</a> </li>
    </ul>
    </li>
    <li class="Folder">4.10
    <ul>
      <li><a href="kernel32/history/names410.htm">Named Exports</a> </li>
      <li><a href="kernel32/history/ords410.htm">Ordinal-Only Exports</a> </li>
    </ul>
    </li>
    <li class="Folder">4.90
    <ul>
      <li><a href="kernel32/history/names490.htm">Named Exports</a> </li>
      <li><a href="kernel32/history/ords490.htm">Ordinal-Only Exports</a> </li>
    </ul>
    </li>
    <li><a href="kernel32/history/names50.htm">5.0</a> </li>
    <li><a href="kernel32/history/names51.htm">5.1</a> </li>
    <li><a href="kernel32/history/names52.htm">5.2</a> </li>
    <li><a href="kernel32/history/names60.htm">6.0</a> </li>
    <li><a href="kernel32/history/names61.htm">6.1</a> </li>
    <li><a href="kernel32/history/names62.htm">6.2</a> </li>
    <li><a href="kernel32/history/names63.htm">6.3</a> </li>
    <li><a href="kernel32/history/names100.htm">10.0</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li><a href="kernel32/api/index.htm">Functions</a> </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">USER32
<ul>
  <li class="Folder">Structures 
  <ul>
    <li><a href="user32/structs/cls.htm">CLS</a> </li>
    <li><a href="user32/structs/handleentry.htm">HANDLEENTRY</a> </li>
    <li><a href="user32/structs/head.htm">HEAD</a> </li>
    <li><a href="user32/structs/procdeskhead.htm">PROCDESKHEAD</a> </li>
    <li><a href="user32/structs/procmarkhead.htm">PROCMARKHEAD</a> </li>
    <li><a href="user32/structs/procobjhead.htm">PROCOBJHEAD</a> </li>
    <li><a href="user32/structs/sbdata.htm">SBDATA</a> </li>
    <li><a href="user32/structs/sbinfo.htm">SBINFO</a> </li>
    <li><a href="user32/structs/shrobjhead.htm">SHROBJHEAD</a> </li>
    <li><a href="user32/structs/thrdeskhead.htm">THRDESKHEAD</a> </li>
    <li><a href="user32/structs/throbjhead.htm">THROBJHEAD</a> </li>
    <li class="Folder"><a href="user32/structs/wnd/index.htm">WND</a>
    <ul>
      <li><a href="user32/structs/wnd/exstyle.htm">ExStyle</a> </li>
      <li><a href="user32/structs/wnd/exstyle2.htm">ExStyle2</a> </li>
      <li><a href="user32/structs/wnd/state.htm">state</a> </li>
      <li><a href="user32/structs/wnd/state2.htm">state2</a> </li>
      <li><a href="user32/structs/wnd/style.htm">style</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="advapi32/index.htm">ADVAPI32</a> 
<ul>
  <li class="Folder"><a href="advapi32/history/index.htm">Versions</a>
  <ul>
    <li><a href="advapi32/history/names351.htm">3.51</a> </li>
    <li><a href="advapi32/history/names40.htm">4.0</a> </li>
    <li><a href="advapi32/history/names470.htm">4.70</a> </li>
    <li><a href="advapi32/history/names480.htm">4.80</a> </li>
    <li><a href="advapi32/history/names490.htm">4.90</a> </li>
    <li><a href="advapi32/history/names50.htm">5.0</a> </li>
    <li><a href="advapi32/history/names51.htm">5.1</a> </li>
    <li><a href="advapi32/history/names52.htm">5.2</a> </li>
    <li><a href="advapi32/history/names60.htm">6.0</a> </li>
    <li class="Folder">6.1
      <ul>
      <li><a href="advapi32/history/names61.htm">Named Exports</a> </li>
      <li><a href="advapi32/history/ords61.htm">Ordinal-Only Exports</a> </li>
      </ul>
    </li>
    <li><a href="advapi32/history/names62.htm">6.2</a> </li>
    <li><a href="advapi32/history/names63.htm">6.3</a> </li>
    <li><a href="advapi32/history/names100.htm">10.0</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="advapi32/api/index.htm">Functions</a> 
<ul>
  <li class="Folder"><a href="advapi32/api/etw/index.htm">Event Tracing</a> 
<ul>
  <li class="Folder">Logging API 
  <ul>
    <li class="Folder">Functions 
    <ul>
      <li><a href="advapi32/api/etw/logapi/starttrace.htm">StartTrace</a> </li>
      <li><a href="advapi32/api/etw/logapi/event.htm">TraceEvent</a> </li>
      <li><a href="advapi32/api/etw/logapi/eventinstance.htm">TraceEventInstance</a> </li>
      <li><a href="advapi32/api/etw/logapi/message.htm">TraceMessage</a> </li>
      <li><a href="advapi32/api/etw/logapi/messageva.htm">TraceMessageVa</a> </li>
      <li><a href="advapi32/api/etw/logapi/query.htm">TraceQueryInformation</a> </li>
      <li><a href="advapi32/api/etw/logapi/set.htm">TraceSetInformation</a> </li>
    </ul>
    </li>
    <li class="Folder">Structures 
    <ul>
      <li><a href="advapi32/api/etw/logapi/event_trace_properties.htm">EVENT_TRACE_PROPERTIES</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">Services 
<ul>
  <li class="Folder">The Service Control Manager 
  <ul>
    <li><a href="services/scm/versions.htm">Versions</a> </li>
  </ul>  
<ul>
  <li class="Folder"><a href="services/scm/events/index.htm">Events</a> 
  <ul>
    <li><a href="services/scm/events/eventlog.htm">System Log</a> </li>
    <li><a href="services/scm/events/diagnostic.htm">Diagnostic Log</a> </li>
    <li><a href="services/scm/events/wpp.htm">WPP Software Tracing</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="services/scm/host/index.htm">The Original Service Host</a> 
<ul>
  <li class="Folder">Service DLL Functions
  <ul>
    <li><a href="services/scm/host/dll/serviceentry.htm">ServiceEntry</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">Host Structures
  <ul>
    <li><a href="services/scm/host/process/globaldata.htm">SVCS_GLOBAL_DATA</a> </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="services/svchost/index.htm">The Service Host</a>
  <ul>
    <li><a href="services/svchost/versions.htm">Versions</a> </li>
  </ul>
<ul>
  <li class="Folder"><a href="services/svchost/process/index.htm">Per-Process Initialisation</a>
  <ul>
    <li>SVCHOST Structures
    <ul>
      <li><a href="services/svchost/process/globaldata.htm">SVCHOST_GLOBAL_DATA</a> </li>
    </ul>
    </li>
    <li>SVCHOST Functions
    <ul>
      <li><a href="services/svchost/process/netbiosclose.htm">NetBiosClose</a> </li>
      <li><a href="services/svchost/process/netbiosopen.htm">NetBiosOpen</a> </li>
      <li><a href="services/svchost/process/netbiosreset.htm">NetBiosReset</a> </li>
      <li><a href="services/svchost/process/registerstopcallback.htm">RegisterStopCallback</a> </li>
      <li><a href="services/svchost/process/startrpcserver.htm">StartRpcServer</a> </li>
      <li><a href="services/svchost/process/stoprpcserver.htm">StopRpcServer</a> </li>
      <li><a href="services/svchost/process/stoprpcserverex.htm">StopRpcServerEx</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">Service DLL Functions
  <ul>
    <li><a href="services/svchost/dll/servicemain.htm">ServiceMain</a> </li>
    <li><a href="services/svchost/dll/svchostpushserviceglobals.htm">SvchostPushServiceGlobals</a>
    </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">FVEAPI (BitLocker)
<ul>
  <li><a href="fveapi/policy/index.htm">Policy Settings</a> </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">COM 
<ul>
  <li class="Folder">Interfaces 
  <ul>
    <li><a href="com/interfaces/iglobaloptions.htm">IGlobalOptions</a> </li>
    <li><a href="com/interfaces/isecurityoptions.htm">ISecurityOptions</a> </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">APPHELP 
<ul>
  <li class="Folder"><a href="apphelp/history/index.htm">Versions</a>
  <ul>
    <li><a href="apphelp/history/names51.htm">5.1</a> </li>
    <li><a href="apphelp/history/names52.htm">5.2</a> </li>
    <li><a href="apphelp/history/names60.htm">6.0</a> </li>
    <li><a href="apphelp/history/names61.htm">6.1</a> </li>
    <li class="Folder">6.2
      <ul>
      <li><a href="apphelp/history/names62.htm">Named Exports</a> </li>
      <li><a href="apphelp/history/ords62.htm">Ordinal-Only Exports</a> </li>
      </ul>
    </li>
    <li><a href="apphelp/history/names63.htm">6.3</a> </li>
    <li class="Folder">10.0 
      <ul>
      <li><a href="apphelp/history/names100.htm">Named Exports</a> </li>
      <li><a href="apphelp/history/ords100.htm">Ordinal-Only Exports</a> </li>
      </ul>
    </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="apphelp/api/index.htm">Functions</a> 
<ul>
  <li class="Folder">Attributes 
  <ul>
    <li><a href="apphelp/api/attributes/sdbtagtostring.htm">SdbTagToString</a> </li>
  </ul>
  </li>
</ul>
<ul>
  <li class="Folder">Matching Information 
  <ul>
    <li class="Folder">Functions 
    <ul>
      <li><a href="apphelp/api/grabmi/sdbgrabmatchinginfo.htm">SdbGrabMatchingInfo</a> </li>
      <li><a href="apphelp/api/grabmi/sdbgrabmatchinginfoex.htm">SdbGrabMatchingInfoEx</a> </li>
    </ul>
    </li>
    <li class="Folder">Constants 
    <ul>
      <li><a href="apphelp/api/grabmi/filter.htm">Filter</a> </li>
    </ul>
    </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder"><a href="apphelp/sdb/index.htm">Shim Database (SDB) Files</a> 
  <ul>
    <li><a href="apphelp/sdb/tag.htm">TAG</a> </li>
    <li><a href="apphelp/sdb/shimdbc.htm">Where is ShimDBC.exe?</a> </li>
    <li><a href="apphelp/sdb/shimdbdc.htm">A Shim Database De-Compiler</a> </li>
  </ul>
  </li>
</ul>
  </li>
</ul>
<pre><code>&lt;ul&gt;
  &lt;li class="Folder"&gt;Desktop Window Manager 
</code></pre>
<ul>
  <li class="Folder">DWMAPI 
<ul>
  <li><a href="dwmapi/history/index.htm">Versions</a> </li>
</ul>
<ul>
  <li><a href="dwmapi/api/index.htm">Functions</a> </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">DWMCORE 
<ul>
  <li><a href="dwmcore/history/index.htm">Versions</a> </li>
</ul>
<ul>
  <li><a href="dwmcore/api/index.htm">Functions</a> </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">DWMREDIR 
<ul>
  <li><a href="dwmredir/history/index.htm">Versions</a> </li>
</ul>
<ul>
  <li><a href="dwmredir/api/index.htm">Functions</a> </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">MILCORE 
<ul>
  <li><a href="milcore/history/index.htm">Versions</a> </li>
</ul>
<ul>
  <li><a href="milcore/api/index.htm">Functions</a> </li>
</ul>
  </li>
</ul>
<ul>
  <li class="Folder">UDWM 
<ul>
  <li><a href="udwm/history/index.htm">Versions</a> </li>
</ul>
<ul>
  <li><a href="udwm/api/index.htm">Functions</a> </li>
</ul>
  </li>
</ul>
<pre><code>  &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
</code></pre>
  </ul>
  <div class="NoScript Footer">
    <ul id="OtherRoot">
      <li class="Folder">Other TOCs (and approximate page counts) 
      <ul>
        <li class="Folder"><a target="_self" href="../../../toc.htm">Geoff Chappell, Software Analyst</a> (155) 
        <ul>
          <li><a target="_self" href="../../../notes/toc.htm">Notes</a> (115) </li>
          <li class="Folder">Studies 
          <ul>
            <li class="Folder">Windows 
            <ul>
              <li><a target="_self" href="../km/toc.htm">Kernel</a> (739) </li>
              <li><a target="_self" href="../shell/toc.htm">The Windows Shell</a> (424) </li>
              <li><a target="_self" href="../ie/toc.htm">Internet Explorer</a> (396) </li>
            </ul>
            </li>
            <li><a target="_self" href="../../msvc/toc.htm">Visual C++</a> (779) </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
    </ul>
  </div>
</div>
</body>
</html>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../geoffchappell/shell/toc.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../geoffchappell/win32/toc.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../geoffchappell/shell/toc.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../geoffchappell/win32/toc.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
